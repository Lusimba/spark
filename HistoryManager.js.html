<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Spark Framework Source: core/HistoryManager.js</title>

	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<link type="text/css" rel="stylesheet" href="styles/sunlight.dark.css">

	<link type="text/css" rel="stylesheet" href="styles/site.spacelab.css">

</head>

<body>
<div class="container-fluid">
	<div class="navbar navbar-fixed-top ">
		<div class="navbar-inner">
			<a class="brand" href="index.html">Spark Framework</a>
			<ul class="nav">
				
				<li class="dropdown">
					<a href="classes.list.html" class="dropdown-toggle" data-toggle="dropdown">Classes<b
						class="caret"></b></a>

					<ul class="dropdown-menu inline">
						
						<li>
							<a href="spark.components.Button.html">spark.components.Button</a>
						</li>
						
						<li>
							<a href="spark.components.Checkbox.html">spark.components.Checkbox</a>
						</li>
						
						<li>
							<a href="spark.components.ComboBox.html">spark.components.ComboBox</a>
						</li>
						
						<li>
							<a href="spark.components.DraggableView.html">spark.components.DraggableView</a>
						</li>
						
						<li>
							<a href="spark.components.Field.html">spark.components.Field</a>
						</li>
						
						<li>
							<a href="spark.components.Form.html">spark.components.Form</a>
						</li>
						
						<li>
							<a href="spark.components.Input.html">spark.components.Input</a>
						</li>
						
						<li>
							<a href="spark.components.Label.html">spark.components.Label</a>
						</li>
						
						<li>
							<a href="spark.components.LabeledInput.html">spark.components.LabeledInput</a>
						</li>
						
						<li>
							<a href="spark.components.Modal.html">spark.components.Modal</a>
						</li>
						
						<li>
							<a href="spark.components.Overlay.html">spark.components.Overlay</a>
						</li>
						
						<li>
							<a href="spark.components.Password.html">spark.components.Password</a>
						</li>
						
						<li>
							<a href="spark.components.Radio.html">spark.components.Radio</a>
						</li>
						
						<li>
							<a href="spark.components.Textarea.html">spark.components.Textarea</a>
						</li>
						
						<li>
							<a href="spark.components.ToggleSwitch.html">spark.components.ToggleSwitch</a>
						</li>
						
						<li>
							<a href="spark.core.HistorManager.TokenTransformer.html">spark.core.HistorManager.TokenTransformer</a>
						</li>
						
						<li>
							<a href="spark.core.HistoryManager.html">spark.core.HistoryManager</a>
						</li>
						
						<li>
							<a href="spark.core.Object.html">spark.core.Object</a>
						</li>
						
						<li>
							<a href="spark.core.Router.html">spark.core.Router</a>
						</li>
						
						<li>
							<a href="spark.core.View.html">spark.core.View</a>
						</li>
						
						<li>
							<a href="spark.widgets.SignUp.html">spark.widgets.SignUp</a>
						</li>
						

					</ul>
				</li>
				
			</ul>
		</div>
	</div>

	<div class="row-fluid">

		
			<div class="span12">
				
				<div id="main">
					


		<h1 class="page-title">Source: core/HistoryManager.js</h1>
    
<section>
	<article>
		<pre
			class="sunlight-highlight-javascript linenums">// Generated by github.com/steida/coffee2closure 0.1.9
goog.provide('spark.core.HistoryManager');
goog.provide('spark.core.HistorManager.TokenTransformer');
goog.require('spark.core.Object');
goog.require('goog.History');
goog.require('goog.history.Html5History');

/**
  HistoryManager class for Spark Framework to handle hashbang or push state
  navigations. This class uses goog.history.Html5History if supported and
  fallbacks to goog.History. HistoryManager can be used as standalone but it's
  more powerful with Router. They will developerd to provide a fully working
  routing mechanism. You should listen `Navigated` event to use HistoryManager
  as standalone.

  @constructor
  @export
  @param   {Object=} options Class options.
  @param   {*=} data Class data
  @extends {spark.core.Object}
 */
spark.core.HistoryManager = function(options, data) {
  var isHtml5HistorySupported, tokenTransformer;
  if (options == null) {
    options = {};
  }
  
/**
    Add a prefix to all routes. Only available for Html5History.
   */
  options.pathPrefix || (options.pathPrefix = options['pathPrefix'] || '');
  spark.core.HistoryManager.superClass_.constructor.call(this, options, data);
  isHtml5HistorySupported = goog.history.Html5History.isSupported();
  if (isHtml5HistorySupported) {
    tokenTransformer = new spark.core.HistorManager.TokenTransformer;
    this.history = new goog.history.Html5History(null, tokenTransformer);
    this.history.setPathPrefix(options.pathPrefix);
    this.history.setUseFragment(false);
  } else {
    this.history = new goog.History();
  }
  goog.events.listen(this.history, goog.history.EventType.NAVIGATE, (function(_this) {
    return function(e) {
      return _this.emit('Navigated', e.token);
    };
  })(this));
  this.history.setEnabled(true);
}
goog.inherits(spark.core.HistoryManager, spark.core.Object);

/**
  Set token method to update history token and change the page url.

  @export
  @param {!string} token Token to change page url.
 */
spark.core.HistoryManager.prototype.setToken = function(token) {
  return this.history.setToken(token);
};

/**
  This class is an implementation of goog.history.Html5History.TokenTransformer.
  I needed to create a new TokenTransformer, because goog's TokenTransformer
  always appends the query string end of the created url. See http://goo.gl/8q40Cc
  That behaviour creates URLs like which has multiple `?` in it somethig like
  that `/books?sortBy=name&order=asc?query=alex?section=sci-fi`.
  I thought it's a bug and created my own TokenTransformer.

  @constructor
  @implements {goog.history.Html5History.TokenTransformer}
 */
spark.core.HistorManager.TokenTransformer = function() {}

/**
  @override
 */
spark.core.HistorManager.TokenTransformer.prototype.createUrl = function(token, pathPrefix, location) {
  return pathPrefix + token;
};

/**
  @override
 */
spark.core.HistorManager.TokenTransformer.prototype.retrieveToken = function(pathPrefix, location) {
  return location.pathname.substr(pathPrefix.length);
};</pre>
	</article>
</section>





				</div>

				<div class="clearfix"></div>
				<footer>
					
					Spark Framework by Fatih Acet <fatih@fatihacet.com>
					<br />
					
					
		<span class="copyright">
		Copyright Â© 2014 - Fatih Acet
		</span>
					<br />
					
		<span class="jsdoc-message">
		Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.2.2</a>
		on 2014-12-21T12:11:05+00:00 using the <a
			href="https://github.com/terryweiss/docstrap">DocStrap template</a>.
		</span>
				</footer>
			</div>

			
			<br clear="both">
		</div>

	</div>
	<!--<script src="scripts/sunlight.js"></script>-->
	<script src="scripts/docstrap.lib.js"></script>
	<script src="scripts/bootstrap-dropdown.js"></script>
	<script src="scripts/toc.js"></script>

	<script>
		$( function () {
			$( "[id*='$']" ).each( function () {
				var $this = $( this );

				$this.attr( "id", $this.attr( "id" ).replace( "$", "__" ) );
			} );

			$( "#toc" ).toc( {
				anchorName  : function ( i, heading, prefix ) {
					return $( heading ).attr( "id" ) || ( prefix + i );
				},
				selectors   : "h1,h2,h3,h4",
				showAndHide : false,
				scrollTo    : "100px"
			} );

			$( "#toc>ul" ).addClass( "nav nav-pills nav-stacked" );
			$( "#main span[id^='toc']" ).addClass( "toc-shim" );
			$( '.dropdown-toggle' ).dropdown();
//			$( ".tutorial-section pre, .readme-section pre" ).addClass( "sunlight-highlight-javascript" ).addClass( "linenums" );

			$( ".tutorial-section pre, .readme-section pre" ).each( function () {
				var $this = $( this );

				var example = $this.find( "code" );
				exampleText = example.html();
				var lang = /{@lang (.*?)}/.exec( exampleText );
				if ( lang && lang[1] ) {
					exampleText = exampleText.replace( lang[0], "" );
					example.html( exampleText );
					lang = lang[1];
				} else {
					lang = "javascript";
				}

				if ( lang ) {

					$this
						.addClass( "sunlight-highlight-" + lang )
						.addClass( "linenums" )
						.html( example.html() );

				}
			} );

			Sunlight.highlightAll( {
				lineNumbers : true,
				showMenu : true,
				enableDoclinks : true
			} );
		} );
	 </script>



	<!--Navigation and Symbol Display-->
	


	<!--Google Analytics-->
	

</body>
</html>
